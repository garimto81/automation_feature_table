# PRD-0008 Checklist: 모니터링 대시보드 구현

## 문서 정보

| 항목 | 내용 |
|------|------|
| **PRD ID** | PRD-0008 |
| **제목** | 모니터링 대시보드 구현 |
| **생성일** | 2026-01-07 |
| **수정일** | 2026-01-07 |
| **상태** | In Progress |
| **진행률** | 15/24 (63%) |

---

## Phase 1: 기본 대시보드 (MVP)

### 1.1 DB 스키마 확장
- [x] table_status 테이블 DDL 작성
- [x] system_health_log 테이블 DDL 작성
- [x] recording_sessions 테이블 DDL 작성
- [x] 인덱스 생성 (table_id, created_at 등)
- [x] 마이그레이션 스크립트 작성

### 1.2 Metabase 설정
- [x] docker-compose에 Metabase 서비스 확인/추가
- [ ] PostgreSQL 데이터 소스 연결
- [ ] 초기 사용자 설정

### 1.3 기본 Questions 생성
- [x] 테이블 상태 Question (SQL 작성됨)
- [x] 핸드 등급 분포 Question (SQL 작성됨)
- [x] 녹화 세션 목록 Question (SQL 작성됨)
- [x] 시스템 헬스 Question (SQL 작성됨)

### 1.4 Dashboard 레이아웃
- [ ] 4개 패널 배치 (테이블/등급/녹화/헬스)
- [ ] Auto-refresh 설정 (5초)
- [ ] 모바일 반응형 확인

---

## Phase 2: 실시간 기능

### 2.1 WebSocket 서버 구현
- [x] FastAPI WebSocket 엔드포인트 (`/ws/dashboard`)
- [x] 연결 관리자 클래스 구현
- [x] 상태 브로드캐스트 로직 (1초 주기)

### 2.2 데이터 동기화
- [x] 테이블 상태 실시간 업데이트 (`MonitoringService.update_table_connection`)
- [x] 핸드 등급 실시간 집계 (`MonitoringService.update_fusion_result`)
- [x] 녹화 세션 상태 동기화 (`MonitoringService.start/stop_recording_session`)

### 2.3 알림 시스템
- [ ] 장애 발생 알림 (Primary/Secondary 연결 끊김)
- [ ] A등급 핸드 알림

---

## Phase 3: 고급 기능 (선택)

### 3.1 추가 기능
- [ ] 리포트 내보내기 (PDF/CSV)
- [ ] 사용자 권한별 뷰 분리
- [ ] 커스텀 시각화 (React 임베드)

---

## 성공 기준

| 지표 | 목표값 | 현재값 | 상태 |
|------|--------|--------|------|
| 데이터 갱신 지연 | < 1초 | 1초 | ✓ |
| 대시보드 가동률 | 99.5% | - | - |
| 동시 접속자 | 50명 | - | - |

---

## 구현 파일

| 파일 | 설명 |
|------|------|
| `src/database/models.py` | TableStatus, SystemHealthLog, RecordingSession 모델 |
| `src/database/monitoring_repository.py` | MonitoringRepository CRUD |
| `src/dashboard/websocket_server.py` | DashboardWebSocket 실시간 서버 |
| `src/dashboard/monitoring_service.py` | MonitoringService 데이터 동기화 서비스 |
| `src/main.py` | PokerHandCaptureSystem - MonitoringService 통합 |
| `tests/test_monitoring_repository.py` | Repository 테스트 (10개) |
| `tests/test_dashboard_websocket.py` | WebSocket 테스트 (19개) |
| `tests/test_monitoring_service.py` | MonitoringService 테스트 (22개) |
| `deploy/metabase/dashboard-queries.sql` | Metabase SQL 쿼리 |
| `deploy/metabase/migrations/001_monitoring_tables.sql` | DB 마이그레이션 |

---

## 관련 PR

| PR | 설명 | 상태 |
|----|------|------|
| - | PRD-0008 Phase 1 구현 | 대기 |

---

## 변경 이력

| 날짜 | 변경 내용 | 작성자 |
|------|----------|--------|
| 2026-01-07 | 초기 체크리스트 생성 | Claude |
| 2026-01-07 | Phase 1-2 구현 완료 (50%) | Claude |
| 2026-01-07 | Phase 2.2 데이터 동기화 완료 (63%) - MonitoringService 추가 | Claude |
